Changes between Mathopd 1.4 and Mathopd 1.5

cgi.c:

	All headers are now converted into HTTP_ environment
	variables, not just some.

	The value of GATEWAY_INTERFACE is now set.

	The value of SERVER_NAME is set to the value of the
	Host: header sent by the client. This appears to make
	the most sense, especially for virtual servers that are
	created with "AnyHost".

config.c:

	The `NumHeaders' keyword has been added to the Tuning
	block. It determines the maximum amount of headers that
	are passed to child programs using HTTP_ variables.

	The `ExtraHeaders' keyword has been added to the Control
	block. It allows one to pass user-defined headers (like
	"Cache-Control" etc.) to the client.

	The "Name" keyword has been removed since it no longer
	has any function.

core.c:

	If connections are active, call poll() with a timeout
	of one minute, rather than infinity. This should take
	care of connections that remain stuck after shutdown.

	The reap_children function has been made external. Also,
	that function now saves the value of errno.

log.c:

	New global function: open_log().

main.c:

	The 'forked' variable is now local.

	Do not allow 'forked' requests when there is no ChildLog.

	Allow ChildLogs that can be %-expanded, just like the other
	log files (via open_log).

	Use cgi_stub for the child process (see stub.c).

mathopd.h:

	Added: request_header structure, nheaders and headers
	members to request structure; num_headers to tuning.
	Added extra_headers to control.
	Added range_s, if_range_s, if_range, range, range_floor,
	range_ceiling, range_suffix, range_total, ius_s, ius,
	rhost and forked to request.

	Removed: cookie, servername from request structure.
	Removed s_name from server structure.

request.c:

	Store all headers in the r->headers array (up to a maximum
	number, determined by NumHeaders.)

	Print extra headers, if defined by the ExtraHeaders keyword.

	Add satisfy_range(). In process_fd(), seek to the correct
	file offset if "Range" header is present in the request. Return
	200, 206 or 416 status based on range headers. Deal with "If-Range"
	headers. Added process_range_header(). Ignore (and log) multiple
	Range headers and requests for multiple ranges.

	Return 412 error for GET requests with If-Unmodified-Since header
	if applicable.

	Do not fold the Request-Line. That is, if the first line after
	the Request-Line ("GET / HTTP/1.1") starts with a space, do not
	treat it as a continuation of the Request-Line.

	Return a 400 rather than 404 error if a virtual server cannot be
	found. This is required by RFC2616. 

	Allow requests with an absolute URI in the Request-Line
	("GET http://localhost/ HTTP/1.1").

stub.c:

	New file. This file is imported from the phpstub program. This
	means that phpstub is now obsolete (as far as Mathopd 1.5 is
	concerned.)
