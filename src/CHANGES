$Id$

CHANGES between mathopd-1.3pl2 and mathopd-1.4b5

A ScriptUser can be defined in a control block. Mathopd will
change its identity to that of the ScriptUser right before
execution.

Scripts can still be run as the owner of the script. This
is governed by the RunScriptsAsOwner parameter (set to 'On'
to enable the old behaviour.)

Note that ScriptUser overrides whatever value is active
for RunScriptsAsOwner, and that no scripts will be run
if neither variable is set and the server is run as root.

LogFormat keyword has been added to generate custom log
formats. See config.c for details. Additional keywords
BytesRead, BytesWritten, ContentLength, Ctime, Method,
Referer, Status, Uri, UserAgent, Version are also added.
The HTTP version can now also be logged.
Thans to Peter Leven for suggesting these changes.

Never return a 403 error code, except if the client's IP
address is explicitly denied access.

Symlinks checking removed; it seems impossible to do
this safely so we might as well dump it.

Do not log a timeout if a client disconnects after the
timeout period.

Add debugging info to get_path_info.

Always open() any file requested. If a file's mtime is
equal to or less then the If-Modified-Since value, but
we do not have read permission on the file, return an
error rather than a 'not modified.'

Return 404 rather than 400, if check_path() fails.

Do not open a custom error file if the request method is
HEAD.

Send a Refresh: header only if the status is 200.

Added MaxAge Control block keyword. If set, mathopd
sends a Cache-Control: max-age header with the set value.

The configuration file can now be specified on the
command line rather than fed through standard input.

PATH_TRANSLATED is no longer set in CGI programs,
as I don't understand its use. I would be very
curious if any programs are broken by this.

Standard input, output and error are not closed
if mathopd is started with the -n flag.

ASCII NUL characters are not allowed in HTTP
headers, as these might upset the various
string-handling routines.

A new AllowedOwners keyword has been added. It
can be used as follows:

 Virtual {
  Host www.an.example
  Control {
   AllowedOwners {
    User foo
    User bar
    Group foo
   }
  }
  Control {
   Alias /
   ...

In this example, files that get retrieved for www.an.example
must be owned by either user foo, user bar or group foo.

Note that mathopd maps the usernames and groupnames
at startup, so if you somehow change the userid or groupid
in /etc/passwd or /etc/group you must restart the server.

AllowedOwners is inheritable.

If you have want to allow access regardless of file
ownership, use

  Control {
   AllowedOwners {
    *
   }
  }

You do not normally have to do this though, since
ownership is not checked if the allowed owner list
is empty. (hm)

If mathopd is started with the -n flag, diagnostic
messages are logged to standard error as well as the
ErrorLog.
